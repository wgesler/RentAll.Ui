<div class="flex content-card-wrap justify-center">
  <section class="content-card">
    <div class="flex justify-between items-center gap-3 bg-slate-300 rounded-t-lg py-0 pl-8 pr-4">
      <span class="flex flex-column items-center gap-3 py-4">
        <mat-icon class="flex-shrink-0">dashboard</mat-icon>
        <span class="flex-shrink-0 text-xl font-medium" style="font-size: 2rem;">Dashboard</span>
      </span>
    </div>
    <mat-card>
      <div class="dashboard-content">
        <div class="welcome-tile">
          <div class="welcome-content">
            @if (profilePictureUrl) {
              <img [src]="profilePictureUrl" alt="Profile Picture" class="profile-picture" />
            } @else {
              <mat-icon class="profile-icon">person</mat-icon>
            }
            <div class="welcome-text">
              <span class="welcome-label">Welcome</span>
              <span class="user-name">{{ getFullName() }}</span>
            </div>
          </div>
          <div class="date-display-inline">
            <p class="date-text">{{ todayDate }}</p>
          </div>
        </div>

        <div class="dashboard-main-content">
          <div class="reservation-tables">
            <mat-expansion-panel class="reservation-section" [expanded]="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h2 class="section-title">Owner Properties</h2>
                </mat-panel-title>
              </mat-expansion-panel-header>
              @if (isLoadingProperties) {
                <div class="loading-container">
                  <mat-spinner [diameter]="40"></mat-spinner>
                  <p>Loading properties...</p>
                </div>
              } @else {
                <div class="tableDiv">
                  <app-data-table
                    [data]="allProperties"
                    [columns]="ownerPropertiesDisplayedColumns"
                    [hasColumnIndex]="false"
                    [hasFilter]="false"
                    [hasToggleTop]="false"
                    [hasButtonTop]="false"
                    [hasActionsRowClick]="true"
                    [hasActionsEdit]="false"
                    [hasActionsDelete]="false"
                    [itemsPerPage]="50"
                    (rowClickEvent)="goToProperty($event)" />
                </div>
              }
            </mat-expansion-panel>

            <mat-expansion-panel class="reservation-section" [expanded]="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <h2 class="section-title">Owner Reservations</h2>
                </mat-panel-title>
              </mat-expansion-panel-header>
              @if (isLoadingReservations) {
                <div class="loading-container">
                  <mat-spinner [diameter]="40"></mat-spinner>
                  <p>Loading reservations...</p>
                </div>
              } @else {
                <div class="tableDiv">
                  <app-data-table
                    [data]="ownerPropertyReservations"
                    [columns]="ownerReservationsDisplayedColumns"
                    [hasColumnIndex]="false"
                    [hasFilter]="false"
                    [hasToggleTop]="false"
                    [hasButtonTop]="false"
                    [hasActionsRowClick]="true"
                    [hasActionsEdit]="false"
                    [hasActionsDelete]="false"
                    [itemsPerPage]="50"
                    (rowClickEvent)="goToReservation($event)"
                    (contactClickEvent)="goToContact($event)" />
                </div>
              }
            </mat-expansion-panel>
          </div>

          <aside class="dashboard-sidebar">
            <div class="sidebar-content">
              <div class="day-box day-box-reservations">
                <div class="day-box-text">
                  <h4 class="day-title">
                    <span>Owner Properties</span>
                  </h4>
                  @if (isLoadingProperties || isLoadingReservations) {
                    <div class="loading-container-small">
                      <mat-spinner [diameter]="24"></mat-spinner>
                    </div>
                  } @else {
                    <div class="reservations-stats">
                      <div class="stat-row">
                        <span class="stat-label">Rented:</span>
                        <span class="stat-value">{{ rentedCount }}</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Vacant:</span>
                        <span class="stat-value">{{ vacantCount }}</span>
                      </div>
                    </div>
                  }
                </div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </mat-card>
  </section>
</div>
