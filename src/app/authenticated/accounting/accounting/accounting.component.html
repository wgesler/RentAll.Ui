<div class="flex content-card-wrap justify-center">
  <section class="content-card">
    <div class="flex justify-between items-center gap-3 bg-slate-300 rounded-t-lg py-0 pl-8 pr-4">
      <span class="flex flex-column items-center gap-3 py-4">
        <mat-icon class="flex-shrink-0">account_balance</mat-icon>
        <span class="flex-shrink-0 text-xl font-medium">Accounting</span>
      </span>
    </div>
    <mat-card>
      <mat-tab-group [selectedIndex]="selectedTabIndex" class="accounting-tabs" (selectedTabChange)="onTabChange($event)">
        <mat-tab label="Invoices">
          <app-invoice-list 
            [embeddedMode]="true"
            [officeId]="selectedOfficeId"
            [reservationId]="selectedReservationId"
            [source]="'accounting'"
            (officeIdChange)="onInvoiceOfficeChange($event)"
            (reservationIdChange)="onInvoiceReservationChange($event)"
            (printInvoiceEvent)="onPrintInvoice($event)">
          </app-invoice-list>
        </mat-tab>
        <mat-tab label="Cost Codes">
          @if (isEditingCostCodes && costCodesId) {
            <app-cost-codes 
              [id]="costCodesId" 
              [officeId]="costCodesOfficeId"
              [embeddedMode]="true" 
              (backEvent)="onCostCodesBack()"
              (savedEvent)="onCostCodesSaved()">
            </app-cost-codes>
          } @else {
            <!-- Action buttons row - First Row -->
            <div class="flex gap-2 mt-4 px-4 justify-end">
              <mat-slide-toggle id="toggle-cost-codes-inactive" [checked]="showInactiveCostCodes" color="primary" (change)="toggleInactiveCostCodes()" class="whitespace-nowrap">
                Inactive
              </mat-slide-toggle>
              <button mat-raised-button type="button" color="primary" id="add-cost-code-button" (click)="onCostCodesAdd()" [disabled]="!selectedOfficeId" class="whitespace-nowrap items-center flex gap-1">
                <mat-icon class="text-base">add</mat-icon>
                <span>Add</span>
              </button>
            </div>
            <!-- Office dropdown row - Second Row -->
            <div class="flex gap-3 items-center mt-3 px-4">
              <mat-form-field appearance="outline" class="office-dropdown">
                <mat-label>Office</mat-label>
                <mat-select [(ngModel)]="selectedOfficeId" (selectionChange)="onCostCodesOfficeChange(selectedOfficeId)">
                  <mat-option [value]="null">All Offices</mat-option>
                  @for (office of costCodesOffices; track office.officeId) {
                    <mat-option [value]="office.officeId">{{ office.name }}</mat-option>
                  }
                </mat-select>
              </mat-form-field>
            </div>
            <app-cost-codes-list 
              [embeddedMode]="true"
              [officeId]="selectedOfficeId"
              [showInactiveInput]="showInactiveCostCodes"
              (officeIdChange)="onCostCodesOfficeChange($event)"
              (addCostCodeEvent)="onCostCodesAdd()"
              (editCostCodeEvent)="onCostCodesEdit($event)">
            </app-cost-codes-list>
          }
        </mat-tab>
        <mat-tab label="General Ledger">
          <app-general-ledger 
            [officeId]="selectedOfficeId"
            (officeIdChange)="onGeneralLedgerOfficeChange($event)">
          </app-general-ledger>
        </mat-tab>
        <mat-tab label="Documents">
          <app-document-list 
            #accountingDocumentList
            [documentTypeId]="DocumentType.Invoice"
            [hideHeader]="true"
            [officeId]="selectedOfficeId"
            (officeIdChange)="onDocumentsOfficeChange($event)">
          </app-document-list>
        </mat-tab>
      </mat-tab-group>
    </mat-card>
  </section>
</div>
