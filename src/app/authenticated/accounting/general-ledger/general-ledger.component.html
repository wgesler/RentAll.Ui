<div class="general-ledger-container">
  <!-- Shared dropdown row -->
  <div class="flex gap-4 items-center mt-3 px-4">
    @if (showOfficeDropdown) {
      <mat-form-field appearance="outline" style="width: 300px;">
        <mat-label>{{ selectedOfficeId ? 'Office' : 'All Offices' }}</mat-label>
          <mat-select [(ngModel)]="selectedOfficeId" (selectionChange)="onOfficeChange()" placeholder="All Offices">
            <mat-option [value]="null">All Offices</mat-option>
          @for (office of offices; track office.officeId) {
            <mat-option [value]="office.officeId">{{ office.name }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    }
    <mat-form-field appearance="outline" style="width: 300px;">
      <mat-label>{{ selectedCompany ? 'Company' : 'All Companies' }}</mat-label>
        <mat-select [(ngModel)]="selectedCompany" (selectionChange)="onCompanyChange()">
          <mat-option [value]="null">All Companies</mat-option>
        @for (company of availableCompanies; track company.value.companyId) {
          <mat-option [value]="company.value">{{ company.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="outline" style="width: 300px;">
      <mat-label>{{ selectedReservationId ? 'Reservation' : 'All Reservations' }}</mat-label>
        <mat-select [(ngModel)]="selectedReservationId" (selectionChange)="onReservationChange()">
          <mat-option [value]="null">All Reservations</mat-option>
        @for (reservation of availableReservations; track reservation.value.reservationId) {
          <mat-option [value]="reservation.value.reservationId">{{ reservation.label }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>
  
  <!-- Action buttons row -->
  <div class="flex justify-end items-center gap-5 mt-3 px-4">
    <mat-slide-toggle id="toggle-general-ledger-inactive" [checked]="showInactive" color="primary" (change)="toggleInactive()" class="whitespace-nowrap">
      Inactive
    </mat-slide-toggle>
    <button mat-raised-button type="button" color="primary" id="add-general-ledger-button" (click)="onAdd()" [disabled]="!selectedOfficeId" class="whitespace-nowrap items-center flex gap-1">
      <mat-icon class="text-base">add</mat-icon>
      <span>Add</span>
    </button>
  </div>
  
  <div class="mt-4 px-4">
    @if (isLoading) {
      <div class="loading-container">
        <mat-spinner [diameter]="40"></mat-spinner>
        <p>Loading ledger lines...</p>
      </div>
    } @else {
      <app-data-table
        [data]="ledgerRows"
        [columns]="generalLedgerColumns"
        [hasFilter]="true"
        [hasButtonTop]="false"
        [hasToggleTop]="false"
        [hasColumnIndex]="false"
        [totalsRow]="totalsRow"
        [totalsLabel]="'Totals:'"
        [itemsPerPage]="100">
      </app-data-table>
    }
  </div>
</div>
